(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aba4b322"],{"4d63":function(e,t,r){var n=r("83ab"),a=r("da84"),s=r("94ca"),c=r("7156"),i=r("9bf2").f,o=r("241c").f,h=r("44e7"),u=r("ad6d"),l=r("9f7f"),f=r("6eeb"),d=r("d039"),p=r("69f3").set,g=r("2626"),v=r("b622"),m=v("match"),x=a.RegExp,S=x.prototype,b=/a/g,w=/a/g,T=new x(b)!==b,_=l.UNSUPPORTED_Y,k=n&&s("RegExp",!T||_||d((function(){return w[m]=!1,x(b)!=b||x(w)==w||"/a/i"!=x(b,"i")})));if(k){var O=function(e,t){var r,n=this instanceof O,a=h(e),s=void 0===t;if(!n&&a&&e.constructor===O&&s)return e;T?a&&!s&&(e=e.source):e instanceof O&&(s&&(t=u.call(e)),e=e.source),_&&(r=!!t&&t.indexOf("y")>-1,r&&(t=t.replace(/y/g,"")));var i=c(T?new x(e,t):x(e,t),n?this:S,O);return _&&r&&p(i,{sticky:r}),i},R=function(e){e in O||i(O,e,{configurable:!0,get:function(){return x[e]},set:function(t){x[e]=t}})},y=o(x),H=0;while(y.length>H)R(y[H++]);S.constructor=O,O.prototype=S,f(a,"RegExp",O)}g("RegExp")},"742b":function(e,t,r){},"8f4b":function(e,t,r){"use strict";var n=r("742b"),a=r.n(n);a.a},cc0d:function(e,t,r){},d20c:function(e,t,r){"use strict";var n=r("cc0d"),a=r.n(n);a.a},efe3:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-container"},[r("form",{staticClass:"search-form",attrs:{action:"/"}},[r("van-search",{attrs:{"show-action":"",placeholder:"请输入搜索关键词",background:"#3296fa"},on:{search:e.onSearch,cancel:e.onCancel,focus:function(t){e.isResultShow=!1}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),e.isResultShow?r("search-result",{attrs:{"search-text":e.searchText}}):e.searchText?r("search-suggestion",{attrs:{"search-text":e.searchText},on:{search:e.onSearch}}):r("search-history",{attrs:{"search-histories":e.searchHistories},on:{"clear-search-histories":function(t){e.searchHistories=[]},search:e.onSearch}})],1)},a=[],s=(r("c975"),r("a434"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-history"},[r("van-cell",{attrs:{title:"搜索历史"}},[e.isDeleteShow?r("div",[r("span",{on:{click:function(t){return e.$emit("clear-search-histories")}}},[e._v("全部删除")]),e._v(" "),r("span",{on:{click:function(t){e.isDeleteShow=!1}}},[e._v("完成")])]):r("van-icon",{attrs:{name:"delete"},on:{click:function(t){e.isDeleteShow=!0}}})],1),e._l(e.searchHistories,(function(t,n){return r("van-cell",{key:n,attrs:{title:t},on:{click:function(r){return e.onSearchItemClick(t,n)}}},[r("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.isDeleteShow,expression:"isDeleteShow"}],attrs:{name:"close"}})],1)}))],2)}),c=[],i={name:"SearchHistory",components:{},props:{searchHistories:{type:Array,required:!0}},data:function(){return{isDeleteShow:!1}},methods:{onSearchItemClick:function(e,t){this.isDeleteShow?this.searchHistories.splice(t,1):this.$emit("search",e)}}},o=i,h=r("2877"),u=Object(h["a"])(o,s,c,!1,null,"4e3f2f3b",null),l=u.exports,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-suggestion"},e._l(e.suggestions,(function(t,n){return r("van-cell",{key:n,attrs:{icon:"search"},on:{click:function(r){return e.$emit("search",t)}}},[r("div",{attrs:{slot:"title"},domProps:{innerHTML:e._s(e.highlight(t))},slot:"title"})])})),1)},d=[],p=(r("4d63"),r("ac1f"),r("25f0"),r("5319"),r("96cf"),r("1da1")),g=r("b775"),v=function(e){return Object(g["a"])({method:"GET",url:"/app/v1_0/suggestion",params:{q:e}})},m=function(e){return Object(g["a"])({method:"GET",url:"/app/v1_0/search",params:e})},x=r("2ef0"),S={name:"SearchSuggestion",props:{searchText:{type:String,required:!0}},data:function(){return{suggestions:[]}},watch:{searchText:{handler:Object(x["debounce"])((function(e){this.loadSearchSuggestions(e)}),200),immediate:!0}},methods:{loadSearchSuggestions:function(e){var t=this;return Object(p["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,v(e);case 3:n=r.sent,a=n.data,t.suggestions=a.data.options,r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](0),t.$toast("数据获取失败，请稍后重试");case 11:case"end":return r.stop()}}),r,null,[[0,8]])})))()},highlight:function(e){var t='<span class="active">'.concat(this.searchText,"</span>"),r=new RegExp(this.searchText,"ig");return e.replace(r,t)}}},b=S,w=(r("8f4b"),Object(h["a"])(b,f,d,!1,null,"372811c7",null)),T=w.exports,_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-result"},[r("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"加载失败，请点击重试"},on:{"update:error":function(t){e.error=t},load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(e,t){return r("article-item",{key:t,attrs:{article:e}})})),1)],1)},k=[],O=r("2909"),R=r("6ea2"),y={name:"SearchResult",components:{ArticleItem:R["a"]},props:{searchText:{type:String,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,page:1,perPage:20,error:!1}},methods:{onLoad:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m({page:e.page,per_page:e.perPage,q:e.searchText});case 3:n=t.sent,a=n.data,s=a.data.results,(r=e.list).push.apply(r,Object(O["a"])(s)),e.loading=!1,s.length?e.page+=1:e.finished=!0,t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),e.error=!0,e.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()}}},H=y,E=Object(h["a"])(H,_,k,!1,null,"587dad06",null),j=E.exports,C=r("5d2d"),I={name:"SearchIndex",components:{SearchHistory:l,SearchSuggestion:T,SearchResult:j},data:function(){return{searchText:"",isResultShow:!1,searchHistories:Object(C["a"])("TOUTIAO_SEARCH_HISTORIES")||[]}},watch:{searchHistories:function(e){Object(C["b"])("TOUTIAO_SEARCH_HISTORIES",e)}},methods:{onSearch:function(e){this.searchText=e;var t=this.searchHistories.indexOf(e);-1!==t&&this.searchHistories.splice(t,1),this.searchHistories.unshift(e),this.isResultShow=!0},onCancel:function(){this.$router.back()}}},$=I,D=(r("d20c"),Object(h["a"])($,n,a,!1,null,"55d8dd5a",null));t["default"]=D.exports}}]);
//# sourceMappingURL=chunk-aba4b322.17d12e46.js.map